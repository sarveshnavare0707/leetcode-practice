Table: Sales

+-------------+-------+
| Column Name | Type  |
+-------------+-------+
| sale_id     | int   |
| product_id  | int   |
| year        | int   |
| quantity    | int   |
| price       | int   |
+-------------+-------+
(sale_id, year) is the primary key (combination of columns with unique values) of this table.
product_id is a foreign key (reference column) to Product table.
Each row of this table shows a sale on the product product_id in a certain year.
Note that the price is per unit.

Table: Product

+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| product_id   | int     |
| product_name | varchar |
+--------------+---------+
product_id is the primary key (column with unique values) of this table.
Each row of this table indicates the product name of each product.

Write a solution to select the product id, year, quantity, and price for the first year of every product sold. If any product is bought multiple times in its first year, return all sales separately.

Return the resulting table in any order.

# Write your MySQL query statement below
select product_id, year as first_year, quantity, price from
(
select product_id, year, quantity, price,
rank() over (partition by product_id order by year) as ranks
from sales
) as T
where ranks=1

# Write your MySQL query statement below
with fys as 
(
    select product_id, min(year) as year
    from sales
    group by product_id
)
select fys.product_id, fys.year as first_year, s.quantity, s.price from fys
join sales s
    on fys.product_id = s.product_id and fys.year = s.year
order by fys.product_id
