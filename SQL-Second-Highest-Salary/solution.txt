Table: Employee

+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
id is the primary key (column with unique values) for this table.
Each row of this table contains information about the salary of an employee.

 

Write a solution to find the second highest distinct salary from the Employee table. If there is no second highest salary, return null (return None in Pandas).

with nt as (select distinct salary from employee order by salary desc limit 2)
select
case
    when count(salary)=1 then null else (select salary from nt order by salary limit 1) end as SecondHighestSalary
    from nt

-- select distinct salary from employee order by salary desc limit 1 offset 1;
-- use denserank()